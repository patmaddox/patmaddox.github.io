---
layout: post
title: Use GUIDs as Your Refs for External Services
date: 2010-09-16 17:56:22.000000000 -06:00
categories: []
tags: []
status: publish
type: post
published: true
meta:
  _edit_last: '2'
  _wp_rp_related_posts_query_result_cache_expiration: '1441536988'
  _wp_rp_related_posts_query_result_cache_4: a:8:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:3:"101";s:5:"score";s:18:"16.518957223053754";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:2:"38";s:5:"score";s:18:"16.177171501209642";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:3:"162";s:5:"score";s:18:"15.854271536826385";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:3:"226";s:5:"score";s:18:"14.126191453821002";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:3:"218";s:5:"score";s:18:"12.739897092632146";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:3:"172";s:5:"score";s:18:"12.382931531410293";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:2:"70";s:5:"score";s:18:"12.382931531410293";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:2:"86";s:5:"score";s:18:"11.207358201468123";}}
author:
  login: pat
  email: patmaddox@me.com
  display_name: pat
  first_name: Pat
  last_name: Maddox
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p>If your application uses a web-based service, you probably have to pass the service an identifier so that you can correlate the service&#8217;s data with your app&#8217;s local data. When using ActiveRecord within your Rails app, the obvious identifier to use is the id primary key. There are a few reasons you may not want to do that:</p>
<ul>
<li>passing the id requires that the object actually be saved (which could mean manual cleanup if saving to the service doesn&#8217;t work)</li>
<li>inconsistent identifiers if you move from a SQL database to a NoSQL store</li>
<li>automated tests can conflict when run from multiple machines</li>
</ul>
<p>There are ways to get around all of these issues but in my experience it&#8217;s simpler to generate a GUID to use as the service identifier. You can do it using the uuidtools gem.</p>
<p>First you need to add a new string field with a limit of 32 characters to your model. Then automatically populate it with a before_create:</p>
<p><script src="http://gist.github.com/582136.js?file=account.rb"></script>
<p>Then you just use it when creating your record.  Here&#8217;s a snippet from a controller in which I create a local ActiveRecord object, as well as an ActiveResource object that uses the GUID identifier:</p>
<p><script src="http://gist.github.com/582136.js?file=accounts_controller.rb"></script></p>
