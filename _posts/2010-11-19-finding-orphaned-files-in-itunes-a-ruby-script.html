---
layout: post
title: Finding Orphaned Files in iTunes (a Ruby Script)
date: 2010-11-19 18:11:46.000000000 -07:00
categories: []
tags: []
status: publish
type: post
published: true
meta:
  _edit_last: '2'
  _wp_rp_related_posts_query_result_cache_expiration: '1441182363'
  _wp_rp_related_posts_query_result_cache_6: a:12:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:3:"889";s:5:"score";s:16:"9.36426245424844";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:3:"463";s:5:"score";s:16:"9.36426245424844";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:4:"1066";s:5:"score";s:17:"8.788898309344876";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:3:"222";s:5:"score";s:16:"7.16703787691222";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:3:"202";s:5:"score";s:16:"7.16703787691222";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:4:"1028";s:5:"score";s:17:"6.591673732008658";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:3:"433";s:5:"score";s:17:"5.780743515792329";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:3:"423";s:5:"score";s:17:"5.780743515792329";}i:8;O:8:"stdClass":2:{s:7:"post_id";s:3:"254";s:5:"score";s:17:"5.780743515792329";}i:9;O:8:"stdClass":2:{s:7:"post_id";s:3:"240";s:5:"score";s:17:"5.780743515792329";}i:10;O:8:"stdClass":2:{s:7:"post_id";s:3:"940";s:5:"score";s:18:"5.2053793708887675";}i:11;O:8:"stdClass":2:{s:7:"post_id";s:3:"440";s:5:"score";s:18:"5.2053793708887675";}}
  _wp_rp_image: empty
  _wp_rp_related_posts_query_result_cache_4: a:8:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:2:"80";s:5:"score";s:17:"16.45157374441592";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:4:"1134";s:5:"score";s:18:"11.438721960446399";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:2:"55";s:5:"score";s:18:"10.656989342934445";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:3:"889";s:5:"score";s:18:"10.417070712928211";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:3:"463";s:5:"score";s:18:"10.417070712928211";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:2:"63";s:5:"score";s:18:"10.417070712928211";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:4:"1066";s:5:"score";s:16:"9.47706345443674";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:3:"166";s:5:"score";s:17:"8.695330836924786";}}
author:
  login: pat
  email: patmaddox@me.com
  display_name: pat
  first_name: Pat
  last_name: Maddox
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
<p>This morning started off not so hot when I discovered that iTunes had randomly deleted a few of my favorite songs.  I went looking through Time Machine for them, and they were nowhere to be found.  I managed to recover all but one of them using <a href="http://www.fadingred.com/senuti/">Senuti</a> to pull the missing files from my iPhone and place them in my iTunes library.</p>
<p>After I did that, I was curious to know if I had any other broken files in my library.  iTunes identifies broken files with an exclamation point &#8211; but only after you try to play the file!  I spent about an hour googling trying to find a quick way to show me all the broken files. All the tips I found were from 2006 and earlier, and none worked on iTunes 10 on my computer.  That&#8217;s when <a href="http://twitter.com/#!/aniero">aniero</a> suggested I write a script to parse my iTunes library XML file and check it against the file system.</p>
<p>Here&#8217;s the script I came up with.  No guarantees that it&#8217;s perfect, but it worked for me:</p>
<p><script src="https://gist.github.com/707065.js?file=find_orphaned_files.rb"></script></p>
