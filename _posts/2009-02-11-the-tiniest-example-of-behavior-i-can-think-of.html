---
layout: post
title: The Tiniest Example of Behavior I Can Think Of
date: 2009-02-11 15:12:42.000000000 -07:00
categories: []
tags: []
status: publish
type: post
published: true
meta:
  _edit_last: '2'
  _wp_rp_related_posts_query_result_cache_expiration: '1441423789'
  _wp_rp_related_posts_query_result_cache_4: a:8:{i:0;O:8:"stdClass":2:{s:7:"post_id";s:4:"1066";s:5:"score";s:18:"22.872053889003755";}i:1;O:8:"stdClass":2:{s:7:"post_id";s:3:"172";s:5:"score";s:18:"22.140898656674878";}i:2;O:8:"stdClass":2:{s:7:"post_id";s:2:"84";s:5:"score";s:17:"21.53013535750355";}i:3;O:8:"stdClass":2:{s:7:"post_id";s:3:"125";s:5:"score";s:18:"17.879487214966986";}i:4;O:8:"stdClass":2:{s:7:"post_id";s:3:"222";s:5:"score";s:18:"14.820538983845314";}i:5;O:8:"stdClass":2:{s:7:"post_id";s:3:"184";s:5:"score";s:18:"14.562304977342402";}i:6;O:8:"stdClass":2:{s:7:"post_id";s:3:"160";s:5:"score";s:18:"13.898763391783657";}i:7;O:8:"stdClass":2:{s:7:"post_id";s:2:"99";s:5:"score";s:18:"13.898763391783657";}}
author:
  login: pat
  email: patmaddox@me.com
  display_name: pat
  first_name: Pat
  last_name: Maddox
excerpt: !ruby/object:Hpricot::Doc
  options: {}
---
</p>
<p>Take the following very simple controller that changes a user&#8217;s</p>
<p>address:</p>
<p><script src="http://gist.github.com/495654.js?file=gistfile1.rb"></script>
<p>It gets the job done.  Until you do a little validation:</p>
<p><script src="http://gist.github.com/495657.js?file=gistfile1.rb"></script></p>
<p>While the system has behavior, the objects don&#8217;t.  A different piece</p>
<p>of code could change the city and/or state but not make this check,</p>
<p>leaving the user in an invalid state.</p></p>
<p>So instead of a user being an object with properties to set, it&#8217;s an</p>
<p>object with behavior, one of which is &#8220;change address.&#8221;</p>
<p><script src="http://gist.github.com/495660.js?file=gistfile1.rb"></script></p>
<p>There&#8217;s another word you&#8217;ve probably heard for this: encapsulation.  A</p>
<p>common explanation of encapsulation includes computed vs stored</p>
<p>values.  Does the circle calculate its area on the fly or does it</p>
<p>return an instance variable?  Clients don&#8217;t have to know!</p></p>
<p>That leads to a very incomplete understanding of encapsulation.</p>
<p>Encapsulation really means to expose behaviors, not data slots.</p>
<h2>Why BDD is not about testing</h2></p>
<p>It&#8217;s obviously very important to test your code, and writing specs can</p>
<p>help to provide some of that safety net.  But you&#8217;ll hear sayings such</p>
<p>as &#8220;test-driven development isn&#8217;t about testing, it&#8217;s about design.&#8221;</p></p>
<p>Unit testing (before or after) helps keep your design simple.  If you</p>
<p>can&#8217;t instantiate and use an object in a barebones test harness,</p>
<p>you&#8217;re going to have bigger problems down the road.</p></p>
<p>Exposing behaviors instead of data is the keystone of good OO design.</p>
<p>If you&#8217;re not exposing behavior, nothing will help you, not even</p>
<p>SOLID.</p></p>
<p>The enlightenment of TDD is that you invent a good design via objects</p>
<p>that are easy to create and use.  The enlightenment of BDD is that</p>
<p>good design is made even better by focusing on behavior.  You get all</p>
<p>the benefits of TDD because you go through the same steps (in fact,</p>
<p>BDD is TDD done right).</p></p>
<p>How do you focus on behavior?  Well, that&#8217;s a mental shift you must</p>
<p>make when programming.  You can use tools to keep you on track.  Two</p>
<p>that I can think of off the top of my head are descriptive strings and</p>
<p>mock objects.</p>
<h3>Example descriptions</h3>
<p>Example descriptions should point to the behavior:</p>
<p><script src="http://gist.github.com/495662.js?file=gistfile1.rb"></script></p>
<p>Both examples mention &#8220;changing the user&#8217;s address&#8221; suggesting that</p>
<p>there&#8217;s a &#8220;change address&#8221; behavior on the User object.</p>
<p>Of course you can do it with Test::Unit</p>
<p><script src="http://gist.github.com/495663.js?file=gistfile1.rb"></script><br />
<h3>Mock objects</h3>
<p>Mock objects also help you focus on the behavior:</p>
<p><script src="http://gist.github.com/495664.js?file=gistfile1.rb"></script></p>
<p>With example descriptions, you have to make the connection between</p>
<p>between that text and the behavior it implies, including the correct</p>
<p>placement for it.  Mock objects are more explicit in pointing to where</p>
<p>behavior should go.</p></p>
<p>Anyway, those are my basic thoughts on behavior, why BDD is valuable,</p>
<p>and how tools like RSpec can help out.</p>
